const translations = {
    'pt': {
        'main-title': "Plano Ultimate: O Vencedor Indiscut√≠vel em Lucratividade",
        'subtitle': "Uma an√°lise de 500 clientes da Megaline revela que o plano Ultimate gera mais receita e oferece maior estabilidade, tornando-se o investimento mais inteligente para os esfor√ßos de marketing.",
        'objective-title': "O Resumo: Foco no 'Ultimate'",
        'objective-p1': "Nossa an√°lise mostra que, embora o plano 'Surf' tenha seus m√©ritos, o <strong>plano 'Ultimate' √© o carro-chefe consistente.</strong>",
        'objective-p2': "Este relat√≥rio ir√° gui√°-lo pelo 'porqu√™' por tr√°s desta conclus√£o e fornecer os dados para apoi√°-la.",
        'findings-title': "A Hist√≥ria em Tr√™s Partes",
        'finding-1': "<strong>O plano 'Ultimate' gera mais dinheiro por usu√°rio.</strong> √â um fato simples que forma a base da nossa hist√≥ria.",
        'finding-2': "<strong>O plano 'Surf' √© uma inc√≥gnita.</strong> Sua receita √© imprevis√≠vel, dependendo de clientes que ultrapassam seus limites. Isso o torna uma aposta mais arriscada para uma renda est√°vel.",
        'finding-3': "<strong>A localiza√ß√£o n√£o importa.</strong> Verificamos e n√£o h√° diferen√ßa significativa de receita entre os usu√°rios da √°rea de NY-NJ e outras regi√µes. A hist√≥ria √© a mesma em todos os lugares.",
        'eda-title': "Vamos Detalhar o 'Porqu√™'",
        'eda-1-p': "Os gr√°ficos a seguir ilustram as principais diferen√ßas no comportamento do usu√°rio e como elas se traduzem em receita.",
        'gallery-title-1': "A Receita do 'Ultimate' √© Maior e Mais Consistente",
        'gallery-summary-1': "<li>O plano 'Ultimate' (em verde) mostra uma lideran√ßa clara e consistente na receita mensal.</li><li>A receita do plano 'Surf' √© mais irregular, com picos ocasionais de cobran√ßas excedentes.</li>",
        'gallery-title-2': "Receita Total: O Cen√°rio Geral",
        'gallery-summary-2': "<li>Quando olhamos para a receita total, a contribui√ß√£o do plano 'Ultimate' √© significativamente maior.</li><li>Isso refor√ßa a ideia de que o 'Ultimate' √© o plano mais lucrativo no geral.</li>",
        'gallery-title-10': "Uma Receita M√©dia por Usu√°rio Mais Alta",
        'gallery-summary-10': "<li>A receita m√©dia dos usu√°rios 'Ultimate' √© consistentemente maior.</li><li>Isso nos diz que, em n√≠vel individual, os clientes 'Ultimate' s√£o mais valiosos.</li>",
        'gallery-title-8': "Um Fluxo de Receita Mais Est√°vel e Previs√≠vel",
        'gallery-summary-8': "<li>A receita dos usu√°rios 'Ultimate' est√° firmemente agrupada, indicando um fluxo de renda previs√≠vel.</li><li>A receita do 'Surf' est√° por toda parte, tornando mais dif√≠cil a previs√£o.</li>",
        'gallery-title-4': "Usu√°rios 'Surf' Est√£o Atingindo Seus Limites de Dados",
        'gallery-summary-4': "<li>Os usu√°rios 'Surf' frequentemente ultrapassam sua franquia de dados, o que √© uma faca de dois gumes.</li><li>Embora gere taxas de excedente, tamb√©m sugere que eles podem ser bons candidatos para um upgrade.</li>",
        'gallery-title-9': "O Uso de Dados √© Mais Disperso para Usu√°rios 'Surf'",
        'gallery-summary-9': "<li>A ampla gama de uso de dados para usu√°rios 'Surf' √© outro sinal de imprevisibilidade.</li><li>Muitos est√£o pr√≥ximos do limite ou muito al√©m dele.</li>",
        'gallery-title-3': "Os H√°bitos de Chamada s√£o Semelhantes",
        'gallery-summary-3': "<li>N√£o h√° diferen√ßa significativa em quanto os usu√°rios de cada plano falam ao telefone.</li><li>Isso nos diz que o comportamento de chamada n√£o √© um fator importante na diferen√ßa de receita.</li>",
        'gallery-title-7': "Usu√°rios 'Ultimate' Enviam Mais Mensagens",
        'gallery-summary-7': "<li>Os usu√°rios 'Ultimate' enviam mais mensagens, provavelmente porque seu plano inclui uma franquia muito maior.</li><li>No entanto, isso n√£o se traduz em um grande impacto na receita.</li>",
        /* --- NOVAS TRADU√á√ïES DO √çNDICE --- */
        'toc-title': "√çndice",
        'toc-link-1': "O Resumo: Foco no 'Ultimate'",
        'toc-link-2': "A Hist√≥ria em Tr√™s Partes",
        'toc-link-3': "Vamos Detalhar o 'Porqu√™'",
        'toc-link-4': "Teste Estat√≠stico",
        'toc-link-5': "Conclus√£o Final da Hist√≥ria",
        'toc-link-6': "Nossa Abordagem",
        'toc-link-7': "As Ferramentas que Usamos",
        'toc-link-8': "Quer Ir Mais Fundo?",
        'translateBtnText': "Translate to English üá∫üá∏",
        'hypothesis-title': "Testes Estat√≠sticos: Validando os Dados",
        'hypothesis-intro': "Depois de ver as diferen√ßas n√≠tidas nas distribui√ß√µes de receita ‚Äî os ganhos consistentes e confi√°veis do plano 'Ultimate' versus a depend√™ncia ca√≥tica do plano 'Surf' em taxas de excedente ‚Äî nossa intui√ß√£o contava uma hist√≥ria. Mas em ci√™ncia de dados, n√£o podemos confiar apenas na intui√ß√£o. Precisamos confrontar os n√∫meros com um desafio estat√≠stico definitivo.<br><br>A principal quest√£o que pairava sobre nossa estrat√©gia de marketing era: <br><b><i>A diferen√ßa de receita que observamos entre os planos 'Surf' e 'Ultimate' √© real ou √© apenas um acaso de amostragem?</b></i>",
        'revenue-verdict': "1. O Veredito da Receita: A Diferen√ßa √© Real e Est√°vel",
        'location-verdict': "2. O Veredito da Localiza√ß√£o: Geografia N√£o √© um Fator",
        'conclusion-revenue-h4': "Conclus√£o sobre a Receita:",
        'conclusion-revenue-ul': "<li>‚úÖ <b>Rejeitamos a Hip√≥tese Nula.</b></li><li>H√° <b>certeza estat√≠stica esmagadora</b> de que a lucratividade superior do plano 'Ultimate' n√£o √© aleat√≥ria. A volatilidade de <b>$0.00</b> destaca sua estabilidade financeira.</li>",
        'conclusion-location-h4': "Conclus√£o sobre a Localiza√ß√£o:",
        'conclusion-location-ul': "<li>‚ùå <b>N√£o conseguimos rejeitar a Hip√≥tese Nula.</b></li><li><b>N√£o h√° evid√™ncia estat√≠stica</b> que sugira que a receita m√©dia difere com base na geografia. Os esfor√ßos de marketing devem <b>focar exclusivamente no tipo de plano.</b></li>",
        'final-conclusion-title': "Conclus√£o Final da Hist√≥ria",
        'final-conclusion-p': `Nossa An√°lise Explorat√≥ria apontou as diferen√ßas, mas o Teste de Hip√≥tese forneceu a <strong>certeza</strong>.<br><br>Ao confrontar a <strong>previsibilidade impec√°vel do plano Ultimate (US$ 70,00)</strong> com a <strong>alta volatilidade do plano Surf (US$ 57,52)</strong>, a evid√™ncia estat√≠stica foi esmagadora: a <strong>diferen√ßa de lucratividade √© real e altamente significativa</strong>. <div class=\"conclusion-box\"> üëë O mandato √© claro: o <strong>plano Ultimate √© o ativo financeiramente superior e mais est√°vel</strong> para a Megaline. </div>`,
        'methodology-title': "Nossa Abordagem",
        'method-1': "<strong>Limpeza de Dados:</strong> Come√ßamos limpando e preparando os dados brutos para garantir a precis√£o.",
        'method-2': "<strong>Engenharia de Atributos:</strong> Criamos novos atributos, como a receita mensal por usu√°rio, para obter uma imagem mais clara dos dados.",
        'method-3': "<strong>An√°lise Explorat√≥ria de Dados (AED):</strong> Usamos visualiza√ß√µes para explorar os dados e descobrir a hist√≥ria.",
        'method-4': "<strong>Teste Estat√≠stico:</strong> Usamos testes de hip√≥teses para confirmar nossas descobertas e garantir que n√£o fossem apenas por acaso.",
        'tech-title': "As Ferramentas que Usamos",
        'reproducibility-title': "Uma Nota sobre os Dados",
        'reproducibility-p': "Este projeto foi conclu√≠do usando conjuntos de dados propriet√°rios. Embora o notebook n√£o seja diretamente execut√°vel, o reposit√≥rio cont√©m todo o c√≥digo e as visualiza√ß√µes para uma revis√£o completa da an√°lise.",
        'cta-title': "Quer Ir Mais Fundo?",
        'cta-p': "A an√°lise completa, incluindo todo o c√≥digo e a metodologia passo a passo, est√° dispon√≠vel no reposit√≥rio do projeto. Esta √© a sua chance de ver o \"como\" por tr√°s do \"o qu√™\".",
        'contact-title': "CONTATE-ME",
        'data-usage': "Uso de Dados",
        'title': "Projeto 1: An√°lise de Receita dos Planos da Megaline",
    }
};

const originalTexts = {};
let currentLanguage = 'en';
const themeIconContainer = document.getElementById('themeIconContainer');
const sunIcon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.64 5.64c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l1.06 1.06c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L5.64 5.64zm12.72 12.72c-.39-.39-1.02-.39-1.41 0-.39.39-.39-1.02 0 1.41l1.06 1.06c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41l-1.06-1.06zM5.64 18.36l-1.06-1.06c-.39-.39-.39-1.02 0-1.41s1.02-.39 1.41 0l1.06 1.06c.39.39.39 1.02 0 1.41s-1.02.39-1.41 0zM19.42 6.01c.39-.39.39-1.02 0-1.41l-1.06-1.06c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l1.06 1.06c.39.39 1.02.39 1.41 0z"/></svg>`;
const moonIcon = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.31 0-6-2.69-6-6 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>`;

function updateTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    themeIconContainer.innerHTML = theme === 'dark' ? moonIcon : sunIcon;
    localStorage.setItem('theme', theme);
}

document.getElementById('themeToggleBtn').addEventListener('click', () => {
    const currentTheme = document.body.getAttribute('data-theme') || 'light';
    updateTheme(currentTheme === 'dark' ? 'light' : 'dark');
});

function setLanguage(lang) {
    currentLanguage = lang;
    if (lang === 'en') {
        for (const id in originalTexts) {
            const element = document.getElementById(id);
            if (element) {
                element.innerHTML = originalTexts[id];
            }
        }
    } else {
        const translationSet = translations[lang];
        for (const id in translationSet) {
            const element = document.getElementById(id);
            if (element) {
                element.innerHTML = translationSet[id];
            }
        }
    }
}

document.getElementById('translateBtn').addEventListener('click', () => {
    setLanguage(currentLanguage === 'en' ? 'pt' : 'en');
});

document.addEventListener('DOMContentLoaded', () => {
    const allIds = new Set(Object.keys(translations.pt));
    allIds.forEach(id => {
        const element = document.getElementById(id);
        if (element) originalTexts[id] = element.innerHTML;
    });
    const savedTheme = localStorage.getItem('theme') || 'light';
    updateTheme(savedTheme);

    // Modal functionality
    var modal = document.getElementById("imageModal");
    var modalImg = document.getElementById("modalImage");
    var modalSummaryList = document.getElementById("modalSummaryList");
    var images = document.querySelectorAll(".gallery-item img");
    images.forEach(image => {
        image.onclick = function(){
            modal.style.display = "block";
            modalImg.src = this.src;
            const summaryList = this.parentElement.querySelector('.summary');
            modalSummaryList.innerHTML = summaryList.innerHTML;
        }
    });

    var span = document.getElementsByClassName("close")[0];

    span.onclick = function() { 
        modal.style.display = "none";
    }

    // Pega o bot√£o
    let mybutton = document.getElementById("backToTopBtn");

    // --- ADICIONE ESTA LINHA ---
    // Diz ao JavaScript para "escutar" por um clique no bot√£o 
    // e, quando acontecer, executar a fun√ß√£o scrollToTop.
    mybutton.addEventListener("click", scrollToTop); 
    // -------------------------

    // Quando o usu√°rio rolar 20px para baixo, mostra o bot√£o
    window.onscroll = function() {
    scrollFunction();
    };

    function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        mybutton.style.display = "flex";
    } else {
        mybutton.style.display = "none";
    }
    }

    // Quando o usu√°rio clica no bot√£o, rola para o topo
    // O linter agora v√™ esta fun√ß√£o sendo usada na linha "addEventListener"
    function scrollToTop() {
    document.body.scrollTop = 0; // Para Safari
    document.documentElement.scrollTop = 0; // Para Chrome, Firefox, IE e Opera
    }

    // Collapsible functionality
    var coll = document.getElementsByClassName("collapsible");
    for (var i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.display === "block") {
        content.style.display = "none";
        this.style.borderBottom = "2px solid var(--border-color-light)";
        } else {
        content.style.display = "block";
        this.style.borderBottom = "none";
        }
    });
    }

    // Menu toggle functionality
    const menuToggleBtn = document.getElementById('menuToggleBtn');
    const headerNav = document.querySelector('.header-nav');
    if (menuToggleBtn && headerNav) {
        menuToggleBtn.addEventListener('click', () => {
            headerNav.classList.toggle('show-nav');
        });
    }

    // Fade-in on scroll functionality
    const revealObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('is-visible');
                observer.unobserve(entry.target);
            }
        });
    }, {
        root: null,
        rootMargin: '0px',
        threshold: 0.15
    });

    // Add the class and observe the elements
    document.querySelectorAll('.section, .collapsible, .gallery-item, .info-box, .conclusion-box').forEach(element => {
        element.classList.add('reveal-on-scroll');
        revealObserver.observe(element);
    });
});